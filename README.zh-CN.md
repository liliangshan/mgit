# MGit - Git 项目管理工具

## 简介
MGit 是一个用于管理多个 Git 项目的命令行工具。它可以帮助您有效地管理、同步和更新多个 Git 仓库。

## 主要功能
- 多项目管理：一键管理多个 Git 项目，提高工作效率
- 多语言支持：支持中文（简体/繁体）、英文、日文、韩文、法文等多种语言
- 远程数据库同步：支持多设备间的项目配置同步，团队协作更便捷
- 版本控制：内置版本管理，支持自动更新
- 系统集成：支持添加到系统环境变量，随时随地使用
- 智能分支管理：自动检测和切换分支，避免冲突
- 批量操作：支持同时拉取/推送多个项目的更改

## 特性说明

### 1. 高效协作
- 多设备配置自动同步，确保团队成员使用相同的项目配置
- 团队项目统一管理，避免配置不一致
- 批量操作节省时间，提高工作效率
- 智能分支管理，自动处理分支切换和同步

### 2. 用户友好
- 交互式命令行界面，操作直观简单
- 多语言本地化支持，无语言障碍
- 智能提示和帮助，降低使用门槛
- 统一的命令格式，易于记忆和使用

### 3. 安全可靠
- 自动备份配置，防止意外丢失
- 版本控制保护，支持回滚操作
- 冲突智能处理，确保数据安全
- 权限管理，防止误操作

### 4. 扩展性强
- 支持自定义配置，满足不同需求
- 灵活的项目管理，适应各种场景
- 持续更新迭代，不断优化功能
- 支持插件扩展，功能可扩展

## 版本更新说明
1.0.16
- 新增应用实例管理功能，支持通过 `mgit new` 创建新的应用实例
- 优化配置文件和数据库命名规则，根据应用名自动生成对应文件名
- 新增环境变量自动设置功能，支持将应用目录添加到系统环境变量
- 更新远程数据库每次强制更新（如果开启远程数据库）
- 单个pull时如果远程有多个分支可以选择要pull的分支，批量pull仍然以数据库的为准
- 增加切换本地分支和远程分支的功能

## 新增功能说明

### 1. 应用实例管理
- 创建新的应用实例：
  ```bash
  mgit new newapp  # 创建一个名为 newapp 的新应用实例
  mgit new         # 交互式创建新应用实例
  ```
  - 新应用将继承当前应用的所有功能
  - 每个应用实例拥有独立的配置文件和数据库
  - 应用名称会自动清理非法字符
  - 如果应用已存在，将提示直接使用现有应用

### 2. 配置文件命名规则
应用会根据程序名称自动选择配置文件：
- mgit.exe：使用 `.env` 文件
- 其他应用：使用 `.应用名.env` 文件
例如：gitmanager.exe -> .gitmanager.env

### 3. 数据库文件命名规则
数据库文件同样遵循应用名称规则：
- mgit.exe：使用 `projects.db` 文件
- 其他应用：使用 `应用名.db` 文件
例如：gitmanager.exe -> gitmanager.db

### 4. 远程数据库目录
远程数据库目录也采用应用名称命名：
- mgit.exe：使用 `.mgit_db` 目录
- 其他应用：使用 `.应用名_db` 目录
例如：gitmanager.exe -> .gitmanager_db

### 5. 环境变量设置
自动设置当前应用目录到系统环境变量：
```bash
mgit env  # 将自动创建 MGIT_PATH 或 应用名_PATH 环境变量
```
- 环境变量名称根据应用名自动生成
- 自动检查是否已存在相同的环境变量
- Windows 系统需要管理员权限
- 某些设置可能需要重启系统后生效

### 注意事项
1. 创建新应用实例时：
   - 会自动启动新创建的应用
   - 新应用拥有独立的配置和数据
   - 如果同名应用已存在则无法创建

2. 环境变量设置：
   - Windows 系统需要管理员权限
   - 可能需要重启系统使环境变量生效
   - 建议使用英文路径避免编码问题

3. 数据存储：
   - 所有配置文件和数据库都存放在应用所在目录
   - 远程数据库目录作为独立的 Git 仓库管理
   - 支持多设备间的配置自动同步

## 安装说明

### 初始化配置
```bash
# 初始化工具
./mgit init
# 或者
./mgit init mgit
```

### 环境配置
```bash
# 设置机器标识
./mgit set machine your-machine-name

# 设置项目存放路径
./mgit set path /your/custom/path

# 查看当前配置
./mgit set
```

## 基础配置
工具使用 .env 文件存储配置：

```env
# 机器标识
MACHINE_ID=machine-01

# 应用路径（存放所有项目的父目录）
APP_PATH=/path/to/projects

# 环境变量设置
MGIT_LANG=zh-CN
```

## 数据库和配置文件说明

### 文件命名规则
应用会根据程序名称自动选择配置文件和数据库文件：

1. 配置文件：
   - mgit.exe：使用 `.env` 文件
   - 其他应用：使用 `.应用名.env` 文件
   例如：gitmanager.exe -> .gitmanager.env

2. 本地数据库：
   - mgit.exe：使用 `projects.db` 文件
   - 其他应用：使用 `应用名.db` 文件
   例如：gitmanager.exe -> gitmanager.db

3. 远程数据库目录：
   - mgit.exe：使用 `.mgit_db` 目录
   - 其他应用：使用 `.应用名_db` 目录
   例如：gitmanager.exe -> .gitmanager_db

### 远程数据库同步
```bash
./mgit set
# 选择 "启用数据库仓库同步"
# 输入数据库仓库地址
```

### 数据同步机制
- 每次 push 操作后自动同步数据库
- 每次 pull 操作前自动获取最新配置
- 支持多人协作，自动合并配置

### 同步内容
- 项目配置信息（保存在 应用名.db 中）
- 分支设置
- 最后提交记录
- 设备标识

### 数据存储位置
1. 本地数据库：
   - 存放在应用程序所在目录
   - 自动根据应用名称创建对应的数据库文件

2. 远程数据库：
   - 存放在 APP_PATH 目录下的 .应用名_db 目录中
   - 作为独立的 Git 仓库进行管理
   - 自动同步和合并多设备间的配置

### 注意事项
- 首次使用时会自动创建相应的数据库文件
- 远程数据库同步需要有效的 Git 仓库地址
- 数据库文件会自动备份以防止数据丢失
- 切换远程数据库时会自动迁移现有数据

## 命令使用说明

### 创建应用实例
```bash
# 创建新的应用实例（指定名称）
./mgit new project_manager

# 创建新的应用实例（交互式）
./mgit new
# 根据提示输入新应用名称
```

### 初始化项目
```bash
# 初始化新项目
./mgit init project_name https://github.com/user/repo.git

# 新建项目
./mgit init mgit
# 或者直接
./mgit init
```

### 拉取代码
```bash
# 拉取单个项目
./mgit pull project_name
# 或者
./mgit pull
# 然后在交互式菜单中选择要同步的项目

# 拉取所有项目
./mgit pull-all
```

### 推送代码
```bash
# 推送单个项目
./mgit push project_name
# 或者
./mgit push
# 然后在交互式菜单中选择要推送的项目
# 之后可以输入提交说明（留空则使用机器名）

# 推送所有项目
./mgit push-all
```

### 分支管理
```bash
# 交互式设置项目分支
./mgit branch

# 直接设置指定项目的本地和远程分支
./mgit branch project_name local_branch remote_branch
```

### 设置拉取分支
```bash
# 交互式设置项目拉取分支
./mgit set pull-branch

# 为特定项目直接设置拉取分支
./mgit set pull-branch project_name branch_name
```

### 项目管理
```bash
# 查看项目列表
./mgit list

# 删除项目
./mgit delete
# 通过交互式菜单选择要删除的项目
```

### 查看帮助
```bash
./mgit help
# 或者使用以下别名
./mgit h
./mgit -h
./mgit -help
```

### 命令说明

#### 代理设置
```bash
mgit proxy
```
设置 Git 代理服务器，支持 HTTP 和 HTTPS 代理。执行命令后，系统会提示：
1. 是否使用代理
2. 选择代理类型（HTTP/HTTPS）
3. 输入代理服务器 IP 地址
4. 输入代理服务器端口

示例：
```bash
$ mgit proxy
是否使用代理？(y/N): y
请选择代理类型：
1) HTTP
2) HTTPS
请选择: 1
请输入代理IP: 127.0.0.1
请输入代理端口: 7890
代理设置成功
```

## 交互式菜单示例

### 项目选择菜单

# 环境变量设置说明

## 命令用法
```bash
mgit env
```

## 功能说明
- 自动将应用程序所在目录设置为系统环境变量
- 环境变量名称会根据应用程序名称自动生成，格式为 `应用名_PATH`
- 例如：
  - mgit.exe -> MGIT_PATH
  - gitmanager.exe -> GITMANAGER_PATH

## 配置文件
- 如果应用名为 mgit 或 mgit.exe，配置文件名为 `.env`
- 其他应用名称，配置文件格式为 `.应用名.env`
- 例如：
  - mgit.exe -> .env
  - gitmanager.exe -> .gitmanager.env

## 注意事项
- Windows 系统需要管理员权限
- Linux/macOS 系统需要 sudo 权限
- 部分设置可能需要重启系统后生效
- 如果环境变量已存在且值相同，将显示提示信息

### 系统环境变量配置

将 MGit 添加到系统 PATH，实现全局访问：

1. Windows:
```powershell
# 将 MGit 目录添加到用户 PATH
setx PATH "%PATH%;D:\path\to\mgit"
```

2. Linux/macOS:
```bash
# 编辑 ~/.bashrc 或 ~/.zshrc
echo 'export PATH="$PATH:/path/to/mgit"' >> ~/.bashrc
source ~/.bashrc
```